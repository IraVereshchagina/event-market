<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Event Market - Real-Time Demo</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/sockjs-client/1.5.1/sockjs.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/stomp.js/2.3.3/stomp.min.js"></script>
    <style>
        body { font-family: sans-serif; text-align: center; margin-top: 50px; }
        .card { border: 1px solid #ccc; padding: 20px; width: 300px; margin: 0 auto; border-radius: 10px; }
        .counter { font-size: 40px; color: #d9534f; font-weight: bold; }
        .status { color: #888; margin-top: 10px; font-size: 14px; }
    </style>
</head>
<body>

<div class="card">
    <h2>–ö–æ–Ω—Ü–µ—Ä—Ç "Rock Night"</h2>
    <p>–°–ø–µ—à–∏—Ç–µ –∫—É–ø–∏—Ç—å –±–∏–ª–µ—Ç—ã!</p>
    <p>–û—Å—Ç–∞–ª–æ—Å—å –º–µ—Å—Ç:</p>
    <div id="seats-counter" class="counter">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
    <div id="status" class="status">üîå –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Å–µ—Ä–≤–µ—Ä—É...</div>
</div>

<script>
    const socket = new SockJS('http://localhost:8085/ws');
    const stompClient = Stomp.over(socket);
    stompClient.debug = null;

    const eventId = 1;

    stompClient.connect({}, function (frame) {
        document.getElementById('status').innerText = '–ü–æ–¥–∫–ª—é—á–µ–Ω–æ. –ñ–¥–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π...';

        stompClient.subscribe('/topic/events/' + eventId, function (message) {
            const eventData = JSON.parse(message.body);

            const counter = document.getElementById('seats-counter');
            counter.innerText = eventData.availableSeats;

            counter.style.color = '#5cb85c';
            setTimeout(() => counter.style.color = '#d9534f', 500);
        });
    }, function(error) {
        document.getElementById('status').innerText = '–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è';
    });
</script>
</body>
</html>